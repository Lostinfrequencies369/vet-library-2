<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="theme-color" content="#070a14" />
  <title>Vet Library</title>

  <!-- Fonts (readable + futuristic) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Cache-safe loader: reads version.json then loads CSS+JS with ?v= -->
  <script>
    (function () {
      const fallbackV = Date.now();
      function inject(v){
        window.__VER__ = v;

        const css = document.createElement("link");
        css.rel = "stylesheet";
        css.href = "assets/style.css?v=" + encodeURIComponent(v);
        document.head.appendChild(css);

        const js = document.createElement("script");
        js.src = "assets/ui.js?v=" + encodeURIComponent(v);
        js.defer = true;
        document.head.appendChild(js);
      }

      fetch("version.json?ts=" + Date.now(), { cache: "no-store" })
        .then(r => r.ok ? r.json() : ({ v: fallbackV }))
        .then(j => inject(j.v ?? fallbackV))
        .catch(() => inject(fallbackV));
    })();
  </script>
</head>

<body>
  <!-- Ambient background layers -->
  <div class="bg">
    <div class="glow glow-cyan"></div>
    <div class="glow glow-mag"></div>
    <div class="gridOverlay"></div>
    <div class="scanlines"></div>
    <div class="vignette"></div>
  </div>

  <!-- PAGE 1: LANDING -->
  <main id="page1" class="page">
    <section class="centerWrap">
      <div class="heroCard riseIn">
        <div class="badge">VET KNOWLEDGE NODE</div>

        <h1 class="heroTitle">VET LIBRARY</h1>
        <div class="heroSub">INFOGRAPHICS DIRECTORY</div>
        <div class="heroBy">Designed by <span class="accent">AM</span></div>

        <button id="enterBtn" class="enterBtn" type="button">
          Tap to Enter Library
        </button>

        <div class="heroHint">Mobile-first • Search • Organ/System-wise</div>
      </div>
    </section>
  </main>

  <!-- PAGE 2: LOADING -->
  <main id="page2" class="page hidden">
    <section class="centerWrap">
      <div class="loaderCard">
        <div class="loaderTitle">Initializing Vet Library…</div>

        <div class="progressRow">
          <div class="progressTrack">
            <div id="barFill" class="progressFill"></div>
          </div>
          <div id="pct" class="pct">0%</div>
        </div>

        <div class="pulseLine">
          <span class="pulseDot"></span>
        </div>

        <div class="loaderMeta">Loading posters + UI modules (cache-safe)…</div>
      </div>
    </section>
  </main>

  <!-- PAGE 3: LIBRARY -->
  <main id="page3" class="page hidden">
    <!-- Topbar -->
    <header class="topbar">
      <button id="menuBtn" class="iconBtn" aria-label="Open menu" type="button">☰</button>

      <div class="brand">
        <div class="brandTitle">Vet Library</div>
        <div class="brandSub">Infographics</div>
      </div>

      <div class="searchWrap">
        <input id="search" class="searchInput" type="search" autocomplete="off"
               placeholder="Search any disease/keyword…" />
        <div id="searchSuggest" class="suggest hidden"></div>
      </div>
    </header>

    <!-- Content -->
    <section class="content">
      <div class="sectionHead">
        <div>
          <div id="sectionHeading" class="sectionTitle">All Sections</div>
          <div id="sectionCount" class="sectionCount">0 poster(s)</div>
        </div>
      </div>

      <div id="grid" class="grid"></div>
      <div id="empty" class="empty hidden">No posters found.</div>
    </section>

    <!-- Drawer -->
    <aside id="drawer" class="drawer hidden" aria-hidden="true">
      <div id="drawerBackdrop" class="drawerBackdrop"></div>

      <div class="drawerPanel">
        <div class="drawerTop">
          <div class="drawerTitle">Sections</div>
          <button id="closeDrawer" class="iconBtn" aria-label="Close menu" type="button">✕</button>
        </div>

        <div id="sectionList" class="sectionList"></div>

        <div class="drawerFooter">
          <div class="small">Tip: selecting a section clears search.</div>
        </div>
      </div>
    </aside>

    <!-- Modal -->
    <div id="modal" class="modal hidden" aria-hidden="true">
      <div id="modalBackdrop" class="modalBackdrop"></div>

      <div class="modalPanel">
        <div class="modalTop">
          <div id="modalTitle" class="modalTitle">Poster</div>
          <button id="modalClose" class="iconBtn" aria-label="Close poster" type="button">✕</button>
        </div>

        <img id="modalImg" class="modalImg" alt="" />

        <div class="modalBottom">
          <a id="fullOpen" class="linkBtn" href="#" target="_blank" rel="noreferrer">Open Full Image</a>
        </div>
      </div>
    </div>
  </main>
</body>
</html>
